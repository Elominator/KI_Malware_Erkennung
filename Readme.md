# KI Malware Erkennung
Quellcode geschrieben für die Bachelorarbeit "Künstliche Intelligenz zur Erkennung unbekannter Schadsoftware"

## Installation 

### Vorraussetzungen
1. Windows Sandbox
2. Python 3.10
3. PyTorch 2.4.0
4. Powershell 7
5. requirements.txt installieren

## Ausführung

### Inference
Batch-Script runSample.bat mit zur testenden Dateipfad als Argument übergeben: runSample.bat "unknown.exe"

Standardmäßig wird das t_model.pth Modell verwendet.

**Achtung**: runSample.bat löscht bei Beginn den gesammten data Ordner.

### Daten sammeln
1. Programme (exe und msi Dateien) in den Ordner ./data/exe/cleanware ablegen
2. automate.ps1 ausführen
3. Warten (Pro Datei wird es ca 3min dauern)

**Achtung**: Die gesammelten Daten können schnell mehrere Gigabyte erreichen. Gesammelte Daten für 900 Samples lagen beim testen bei ca. 300GB.

### Training

#### Vorraussetzung
1. Trainingsdaten in dem Ordner ./data/encoded
2. Labeldaten in dem Ordner ./data/classifications

#### Ausführung
- trainLSTM.py ausführen um ein LSTM Modell auf den Daten zu trainieren.
- trainTransformer.py ausführen um ein Transformer Modell auf den Daten zu trainieren.

### Hyperparameter Optimisierung

#### Vorraussetzung
1. Trainingsdaten in dem Ordner ./data/encoded
2. Labeldaten in dem Ordner ./data/classifications

#### Ausführung
- optimization.py ausführen um die Hyperparameter für ein Transformer Modell zu optimieren.